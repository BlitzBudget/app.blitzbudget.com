(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{660:function(t,e,n){"use strict";n.r(e);var o=n(4),r=(n(18),n(41)),l={name:"goal-link",components:{BaseTable:r.f,BaseProgress:r.d,Modal:r.g},data:function(){return{goalLink:[],modals:{mini:!1},goalRuleId:null,noData:!1}},methods:{openModal:function(t){this.modals.mini=!0,this.goalRuleId=t},closeModal:function(){this.modals.mini=!1,this.goalRuleId=null},deleteItem:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$wallet.setCurrentWallet(t);case 2:return n=e.sent,e.next=5,t.$axios.$post("/delete-item",{pk:n.WalletId,sk:t.goalRuleId}).then(Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.closeModal(),e.next=3,t.fetchGoalLink();case 3:case"end":return e.stop()}}),e)})))).catch((function(e){t.$notify({type:"danger",icon:"tim-icons icon-simple-remove",verticalAlign:"bottom",horizontalAlign:"center",message:e}),t.closeModal()}));case 5:case"end":return e.stop()}}),e)})))()},noDataInResponse:function(t){this.$isEmpty(t)&&(this.noData=!0)},fetchGoalLink:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$wallet.setCurrentWallet(t);case 2:return n=e.sent,o=t.$route.query.goal_id,e.next=6,t.getGoalRules(n.WalletId,o);case 6:case"end":return e.stop()}}),e)})))()},getGoalRules:function(t,e){var n=this;return Object(o.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.$axios.$post("/rules/goal",{wallet_id:t,goal_id:e}).then(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.goalLink=e,n.noDataInResponse(e),t.next=4,n.getGoals(e);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){n.$notify({type:"danger",icon:"tim-icons icon-simple-remove",verticalAlign:"bottom",horizontalAlign:"center",message:t})}));case 2:case"end":return r.stop()}}),r)})))()},getGoals:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.$isEmpty(t)){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,e.$wallet.setCurrentWallet(e);case 4:return o=n.sent,n.next=7,e.$axios.$post("/goals",{wallet_id:o.WalletId}).then((function(t){e.assignGoalsToTable(t)})).catch((function(t){e.$notify({type:"danger",icon:"tim-icons icon-simple-remove",verticalAlign:"bottom",horizontalAlign:"center",message:t})}));case 7:case"end":return n.stop()}}),n)})))()},assignGoalsToTable:function(t){if(!this.$isEmpty(t))for(var i=0,e=t.length;i<e;i++){var n=t[i],o=document.getElementsByClassName(n.sk);if(!this.$isEmpty(o))for(var r=0,l=o.length;r<l;r++){o[r].textContent=n.goal_name}}}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchGoalLink();case 2:case"end":return e.stop()}}),e)})))()}},c=l,d=n(2),component=Object(d.a)(c,(function(){var t=this,e=t._self._c;return e("card",{staticClass:"card"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-6"},[e("h3",{staticClass:"card-title",attrs:{slot:"header"},slot:"header"},[t._v(t._s(t.$t("goal.link.get.title")))])]),t._v(" "),e("div",{staticClass:"col-sm-6"},[e("nuxt-link",{staticClass:"btn btn-link btn-primary float-right",attrs:{to:"/goal/link/add"}},[t._v(t._s(t.$t("goal.link.get.add"))+"\n            ")])],1)]),t._v(" "),e("div",{staticClass:"table-responsive"},[e("base-table",{attrs:{data:t.goalLink,"thead-classes":"text-primary"},scopedSlots:t._u([{key:"columns",fn:function(n){n.columns;return[e("th",[t._v(t._s(t.$t("goal.link.get.table.header.description")))]),t._v(" "),e("th",[t._v(t._s(t.$t("goal.link.get.table.header.goal")))]),t._v(" "),e("th",{staticClass:"text-right"},[t._v(t._s(t.$t("goal.link.get.table.header.action")))])]}},{key:"default",fn:function(n){var o=n.row,r=n.index;return[e("td",[t._v(t._s(o.transaction_name))]),t._v(" "),e("td",{class:o.goal_id}),t._v(" "),e("td",{staticClass:"text-right"},[e("el-tooltip",{attrs:{content:t.$t("goal.link.get.table.link"),effect:"light","open-delay":300,placement:"top"}},[e("nuxt-link",{staticClass:"btn-link btn-neutral",attrs:{to:{path:"/goal/link/add",query:{goal_id:o.goal_id}},type:r>2?"success":"neutral",icon:"",size:"sm"}},[e("i",{staticClass:"tim-icons icon-link-72"})])],1),t._v(" "),e("el-tooltip",{attrs:{content:t.$t("goal.link.get.table.goal"),effect:"light","open-delay":300,placement:"top"}},[e("nuxt-link",{staticClass:"btn-link btn-neutral",attrs:{to:"/goals",type:r>2?"success":"neutral",icon:"",size:"sm"}},[e("i",{staticClass:"tim-icons icon-trophy"})])],1),t._v(" "),e("el-tooltip",{attrs:{content:t.$t("goal.link.get.table.delete"),effect:"light","open-delay":300,placement:"top"}},[e("base-button",{staticClass:"btn-link",attrs:{type:r>2?"danger":"neutral",icon:"",size:"sm"},on:{click:function(e){return t.openModal(o.sk)}}},[e("i",{staticClass:"tim-icons icon-simple-remove"})])],1)],1)]}}])}),t._v(" "),e("div",{class:[{"show d-block text-center":t.noData},{"d-none":!t.noData}]},[t._v("\n            "+t._s(t.$t("goal.link.get.no-data"))+"\n        ")]),t._v(" "),e("modal",{staticClass:"modal-primary",attrs:{show:t.modals.mini,"show-close":!0,headerClasses:"justify-content-center",type:"mini"},on:{"update:show":function(e){return t.$set(t.modals,"mini",e)}}},[e("p",[t._v(t._s(t.$t("goal.link.delete.description")))]),t._v(" "),e("template",{slot:"footer"},[e("base-button",{attrs:{type:"neutral",link:""},nativeOn:{click:function(e){t.modals.mini=!1}}},[t._v(t._s(t.$t("goal.link.get.back"))+"\n                ")]),t._v(" "),e("base-button",{attrs:{type:"neutral",link:""},on:{click:function(e){return t.deleteItem()}}},[t._v(t._s(t.$t("goal.link.get.delete"))+"\n                ")])],1)],2)],1)])}),[],!1,null,null,null);e.default=component.exports}}]);