(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{658:function(t,e,n){"use strict";n.r(e);var r=n(4),o=(n(18),n(41)),c={name:"category-link",components:{BaseTable:o.f,BaseProgress:o.d,Modal:o.g},data:function(){return{categoryLink:[],modals:{mini:!1},categoryRuleId:null,noData:!1}},methods:{openModal:function(t){this.modals.mini=!0,this.categoryRuleId=t},closeModal:function(){this.modals.mini=!1,this.categoryRuleId=null},getCategoryRules:function(t,e){var n=this;return Object(r.a)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,n.$axios.$post("/rules/category",{wallet_id:t,category_id:e}).then(function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.categoryLink=e,n.noDataInResponse(e),t.next=4,n.getCategories(e);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){n.$notify({type:"danger",icon:"tim-icons icon-simple-remove",verticalAlign:"bottom",horizontalAlign:"center",message:t})}));case 2:case"end":return o.stop()}}),o)})))()},getCategories:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.$isEmpty(t)){n.next=2;break}return n.abrupt("return");case 2:return r=e.getCategoryIds(t),o=e.$authentication.fetchCurrentUser(e).financialPortfolioId,n.next=6,e.$axios.$post("/categories/batch",{user_id:o,category_ids:r}).then((function(t){e.assignCategoriesToTable(t)})).catch((function(t){e.$notify({type:"danger",icon:"tim-icons icon-simple-remove",verticalAlign:"bottom",horizontalAlign:"center",message:t})}));case 6:case"end":return n.stop()}}),n)})))()},getCategoryIds:function(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];e.push(r.category_id)}return e},deleteItem:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$wallet.setCurrentWallet(t);case 2:return n=e.sent,e.next=5,t.$axios.$post("/delete-item",{pk:n.WalletId,sk:t.categoryRuleId}).then(Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.closeModal(),e.next=3,t.fetchCategoryLink();case 3:case"end":return e.stop()}}),e)})))).catch((function(e){t.$notify({type:"danger",icon:"tim-icons icon-simple-remove",verticalAlign:"bottom",horizontalAlign:"center",message:e}),t.closeModal()}));case 5:case"end":return e.stop()}}),e)})))()},assignCategoriesToTable:function(t){if(!this.$isEmpty(t))for(var i=0,e=t.length;i<e;i++){var n=t[i],r=document.getElementsByClassName(n.sk);if(!this.$isEmpty(r))for(var o=0,c=r.length;o<c;o++){r[o].textContent=n.category_type+" : "+n.category_name}}},noDataInResponse:function(t){this.$isEmpty(t)&&(this.noData=!0)},fetchCategoryLink:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$wallet.setCurrentWallet(t);case 2:return n=e.sent,r=t.$route.query.category_id,e.next=6,t.getCategoryRules(n.WalletId,r);case 6:case"end":return e.stop()}}),e)})))()}},mounted:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchCategoryLink();case 2:case"end":return e.stop()}}),e)})))()}},l=c,d=n(2),component=Object(d.a)(l,(function(){var t=this,e=t._self._c;return e("card",{staticClass:"card"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-6"},[e("h3",{staticClass:"card-title",attrs:{slot:"header"},slot:"header"},[t._v(t._s(t.$t("category.link.get.title")))])]),t._v(" "),e("div",{staticClass:"col-sm-6"},[e("nuxt-link",{staticClass:"btn btn-link btn-primary float-right",attrs:{to:"/category/link/add"}},[t._v(t._s(t.$t("category.link.get.add"))+"\n            ")])],1)]),t._v(" "),e("div",{staticClass:"table-responsive"},[e("base-table",{attrs:{data:t.categoryLink,"thead-classes":"text-primary"},scopedSlots:t._u([{key:"columns",fn:function(n){n.columns;return[e("th",[t._v(t._s(t.$t("category.link.get.table.header.description")))]),t._v(" "),e("th",[t._v(t._s(t.$t("category.link.get.table.header.category")))]),t._v(" "),e("th",{staticClass:"text-right"},[t._v(t._s(t.$t("category.link.get.table.header.action")))])]}},{key:"default",fn:function(n){var r=n.row,o=n.index;return[e("td",[t._v(t._s(r.transaction_name))]),t._v(" "),e("td",{class:r.category_id}),t._v(" "),e("td",{staticClass:"text-right"},[e("el-tooltip",{attrs:{content:t.$t("category.link.get.table.link"),effect:"light","open-delay":300,placement:"top"}},[e("nuxt-link",{staticClass:"btn-link btn-neutral",attrs:{to:{path:"/category/link/add",query:{category_id:r.category_id}},type:o>2?"success":"neutral",icon:"",size:"sm"}},[e("i",{staticClass:"tim-icons icon-link-72"})])],1),t._v(" "),e("el-tooltip",{attrs:{content:t.$t("category.link.get.table.category"),effect:"light","open-delay":300,placement:"top"}},[e("nuxt-link",{staticClass:"btn-link btn-neutral",attrs:{to:"/categories",type:o>2?"success":"neutral",icon:"",size:"sm"}},[e("i",{staticClass:"tim-icons icon-components"})])],1),t._v(" "),e("el-tooltip",{attrs:{content:t.$t("category.link.get.table.delete"),effect:"light","open-delay":300,placement:"top"}},[e("base-button",{staticClass:"btn-link",attrs:{type:o>2?"danger":"neutral",icon:"",size:"sm"},on:{click:function(e){return t.openModal(r.sk)}}},[e("i",{staticClass:"tim-icons icon-simple-remove"})])],1)],1)]}}])}),t._v(" "),e("div",{class:[{"show d-block text-center":t.noData},{"d-none":!t.noData}]},[t._v("\n            "+t._s(t.$t("category.link.get.no-data"))+"\n        ")]),t._v(" "),e("modal",{staticClass:"modal-primary",attrs:{show:t.modals.mini,"show-close":!0,headerClasses:"justify-content-center",type:"mini"},on:{"update:show":function(e){return t.$set(t.modals,"mini",e)}}},[e("p",[t._v(t._s(t.$t("category.link.delete.description")))]),t._v(" "),e("template",{slot:"footer"},[e("base-button",{attrs:{type:"neutral",link:""},nativeOn:{click:function(e){t.modals.mini=!1}}},[t._v(t._s(t.$t("category.link.get.back"))+"\n                ")]),t._v(" "),e("base-button",{attrs:{type:"neutral",link:""},on:{click:function(e){return t.deleteItem()}}},[t._v(t._s(t.$t("category.link.get.delete"))+"\n                ")])],1)],2)],1)])}),[],!1,null,null,null);e.default=component.exports}}]);