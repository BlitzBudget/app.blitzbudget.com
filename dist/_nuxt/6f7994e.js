(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{581:function(t,e,n){var content=n(602);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(7).default)("03b7497a",content,!0,{sourceMap:!1})},601:function(t,e,n){"use strict";n(581)},602:function(t,e,n){var r=n(6)((function(i){return i[1]}));r.push([t.i,".white-content .modal.modal-black .modal-content{background:#fff}",""]),r.locals={},t.exports=r},627:function(t,e,n){"use strict";n.r(e);var r,o=n(4),c=n(5),l=(n(575),n(64),n(576)),d=n.n(l),h=(n(251),n(127)),m=n.n(h),f=(n(578),n(579)),v=n.n(f),_=(n(422),n(423)),y=n.n(_),w=(n(424),n(425)),$=n.n(w),x=(n(18),n(8),n(249),n(25),n(10),n(26),n(164),n(41)),C=n(56),k=n.n(C),D={components:(r={BaseTable:x.f,BaseProgress:x.d,Modal:x.g},Object(c.a)(r,$.a.name,$.a),Object(c.a)(r,y.a.name,y.a),Object(c.a)(r,v.a.name,v.a),Object(c.a)(r,m.a.name,m.a),Object(c.a)(r,d.a.name,d.a),r),data:function(){return{tableData:[],currency:null,categories:[],startsWithDate:null,endsWithDate:null,noData:!1,loading:!0,transactions:[],budgets:[],showTransactionsInModal:null,categoryTransactions:new Map,modals:{transaction:!1}}},methods:{showTransactions:function(t){this.modals.transaction=!0;var e=this.categoryTransactions.get(t);this.showTransactionsInModal=e},getBudgets:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.$axios.$post("/budgets",{wallet_id:t}).then((function(t){e.tableData=t,e.fetchCategoryLink(),e.noDataInResponse(t),e.loading=!1})).catch((function(t){e.$notify({type:"danger",icon:"tim-icons icon-simple-remove",verticalAlign:"bottom",horizontalAlign:"center",message:t})}));case 2:case"end":return n.stop()}}),n)})))()},getCategories:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.$axios.$post("/categories",{user_id:t}).then(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.assignCategoriesToTable(n),t.next=3,e.getTransactions();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){var n=e.$lastElement(e.$splitElement(t.data.message,":"));e.$notify({type:"danger",icon:"tim-icons icon-simple-remove",verticalAlign:"bottom",horizontalAlign:"center",message:n})}));case 2:case"end":return n.stop()}}),n)})))()},assignCategoriesToTable:function(t){if(!this.$isEmpty(t)){for(var e=new Map,i=0,n=t.length;i<n;i++){var r=t[i];e.set(r.sk,r.category_type+" : "+r.category_name)}this.setCategoryNameToBudget(e)}},setCategoryNameToBudget:function(t){for(var i=0,e=this.tableData.length;i<e;i++){var n=this.tableData[i],r=t.get(n.category);this.$isNotEmpty(r)&&(this.tableData[i].categoryName=r)}},fetchCategoryLink:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$authentication.fetchCurrentUser(t).financialPortfolioId,e.next=3,t.getCategories(n);case 3:case"end":return e.stop()}}),e)})))()},setDatesToFetchBudget:function(){var t=new Date,e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),1));this.startsWithDate=e.toISOString().substring(0,10);var n=new Date(Date.UTC(t.getFullYear(),t.getMonth()+1,0));this.endsWithDate=n.toISOString().substring(0,10)},handleDelete:function(t){var e=this;k.a.fire({title:this.$nuxt.$t("budget.delete.confirm"),text:this.$nuxt.$t("budget.delete.confirmationText"),type:"warning",showCancelButton:!0,confirmButtonClass:"btn btn-success btn-fill",cancelButtonClass:"btn btn-danger btn-fill",confirmButtonText:this.$nuxt.$t("budget.delete.button"),buttonsStyling:!1}).then(function(){var n=Object(o.a)(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!r.value){n.next=3;break}return n.next=3,e.deleteItem(t);case 3:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())},deleteItem:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.$wallet.setCurrentWallet(e);case 2:return r=n.sent,n.next=5,e.$axios.$post("/delete-item",{pk:r.WalletId,sk:t.sk}).then(Object(o.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.deleteRow(t),r=e.$nuxt.$t("budget.delete.success.description"),e.$notify({type:"success",icon:"tim-icons icon-check-2",verticalAlign:"bottom",horizontalAlign:"center",message:r});case 3:case"end":return n.stop()}}),n)})))).catch((function(t){e.$notify({type:"danger",icon:"tim-icons icon-simple-remove",verticalAlign:"bottom",horizontalAlign:"center",message:t}),e.closeModal()}));case 5:case"end":return n.stop()}}),n)})))()},deleteRow:function(t){var e=this.tableData.findIndex((function(e){return e.id===t.id}));e>=0&&this.tableData.splice(e,1)},noDataInResponse:function(t){this.$isEmpty(t)&&(this.noData=!0)},getTransactions:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$wallet.setCurrentWallet(t);case 2:return n=e.sent,e.next=5,t.$axios.$post("/transactions",{wallet_id:n.WalletId,starts_with_date:t.startsWithDate,ends_with_date:t.endsWithDate}).then((function(e){t.transactions=e,t.calculateCategorySpent(e)})).catch((function(e){t.$notify({type:"danger",icon:"tim-icons icon-simple-remove",verticalAlign:"bottom",horizontalAlign:"center",message:e})}));case 5:case"end":return e.stop()}}),e)})))()},calculateCategorySpent:function(t){if(!this.$isEmpty(t)){for(var e=new Map,i=0,n=t.length;i<n;i++){var r=t[i],o=e.get(r.category_id);if(this.$isEmpty(o)){o=r.amount;var c=[];c.push(r),e.set(r.category_id,o),this.categoryTransactions.set(r.category_id,c)}else{o+=r.amount,e.set(r.category_id,o);var l=this.categoryTransactions.get(r.category_id);l.push(r),this.categoryTransactions.set(r.category_id,l)}}this.assignBudgetUsed(e)}},assignBudgetUsed:function(t){if(!this.$isEmpty(this.tableData)){for(var i=0,e=this.tableData.length;i<e;i++){var n=this.tableData[i],r=n.category,o=t.get(r);n.used=this.$isEmpty(o)?0:o,n.percentage=n.used/n.planned*100}this.budgets=this.tableData}}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setDatesToFetchBudget(),e.next=3,t.$wallet.setCurrentWallet(t);case 3:return n=e.sent,e.next=6,t.getBudgets(n.WalletId);case 6:t.currency=n.WalletCurrency;case 7:case"end":return e.stop()}}),e)})))()}},T=D,R=(n(601),n(2)),O={name:"budget",components:{DisplayBudget:Object(R.a)(T,(function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"display-budget"}},[e("div",{staticClass:"table-responsive"},[e("base-table",{attrs:{data:t.budgets,"thead-classes":"text-primary"},scopedSlots:t._u([{key:"columns",fn:function(n){n.columns;return[e("th",[t._v(t._s(t.$t("budget.get.header.category")))]),t._v(" "),e("th",[t._v(t._s(t.$t("budget.get.header.progress")))]),t._v(" "),e("th",{staticClass:"text-right"},[t._v(t._s(t.$t("budget.get.header.used")))]),t._v(" "),e("th",{staticClass:"text-right"},[t._v(t._s(t.$t("budget.get.header.planned")))]),t._v(" "),e("th",{staticClass:"text-right"},[t._v(t._s(t.$t("budget.get.header.actions")))])]}},{key:"default",fn:function(n){var r=n.row,o=n.index;return[e("td",[t._v(t._s(r.categoryName))]),t._v(" "),e("td",{staticClass:"text-center"},[e("base-progress",{attrs:{value:r.percentage}})],1),t._v(" "),e("td",{staticClass:"text-right"},[t._v(t._s(t.$n(r.used))+" "+t._s(t.currency))]),t._v(" "),e("td",{staticClass:"text-right"},[t._v(t._s(t.$n(r.planned))+" "+t._s(t.currency))]),t._v(" "),e("td",{staticClass:"text-right"},[e("el-tooltip",{attrs:{content:t.$t("budget.get.viewTransactions"),effect:"light","open-delay":300,placement:"top"}},[e("base-button",{staticClass:"btn-link",attrs:{type:o>2?"danger":"neutral",icon:"",size:"sm"},nativeOn:{click:function(e){return t.showTransactions(r.category)}}},[e("i",{staticClass:"tim-icons icon-coins"})])],1),t._v(" "),e("el-tooltip",{attrs:{content:t.$t("budget.get.edit"),effect:"light","open-delay":300,placement:"top"}},[e("nuxt-link",{staticClass:"btn-link",class:o>2?"btn-warning":"btn-neutral",attrs:{icon:"",size:"sm",to:{name:"budget-edit___"+t.$i18n.locale,params:{budget_id:r.sk,planned:r.planned,category_id:r.category}}}},[e("i",{staticClass:"tim-icons icon-pencil"})])],1),t._v(" "),e("el-tooltip",{attrs:{content:t.$t("budget.get.delete"),effect:"light","open-delay":300,placement:"top"}},[e("base-button",{staticClass:"btn-link",attrs:{type:o>2?"danger":"neutral",icon:"",size:"sm"},nativeOn:{click:function(e){return t.handleDelete(r)}}},[e("i",{staticClass:"tim-icons icon-simple-remove"})])],1)],1)]}}])}),t._v(" "),e("div",{class:[{"show d-block text-center":t.noData},{"d-none":!t.noData}]},[t._v("\n            "+t._s(t.$t("budget.get.no-data"))+"\n        ")]),t._v(" "),e("div",{class:[{"show d-block text-center":t.loading},{"d-none":!t.loading}]},[t._v("\n            "+t._s(t.$t("budget.get.loading"))+"\n        ")])],1),t._v(" "),e("modal",{staticClass:"modal-black",attrs:{show:t.modals.transaction},on:{"update:show":function(e){return t.$set(t.modals,"transaction",e)}}},[e("base-table",{attrs:{data:t.showTransactionsInModal,"thead-classes":"text-primary"},scopedSlots:t._u([{key:"columns",fn:function(n){n.columns;return[e("th",[t._v(t._s(t.$t("transaction.get.creation_date")))]),t._v(" "),e("th",[t._v(t._s(t.$t("transaction.get.description")))]),t._v(" "),e("th",[t._v(t._s(t.$t("transaction.get.amount")))]),t._v(" "),e("th",{staticClass:"text-center"},[t._v(t._s(t.$t("transaction.get.tags")))])]}},{key:"default",fn:function(n){var r=n.row;n.index;return[e("td",[t._v(t._s(new Date(r.creation_date).toLocaleDateString(t.$i18n.locale,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})))]),t._v(" "),e("td",[t._v(t._s(r.description))]),t._v(" "),e("td",{staticClass:"text-right"},[t._v(t._s(t.$n(r.amount))+" "+t._s(t.currency))]),t._v(" "),e("td",t._l(r.tags,(function(n){return e("span",{key:n},[e("el-tag",{attrs:{size:"small",type:"info"}},[t._v(t._s(n))])],1)})),0)]}}])}),t._v(" "),e("template",{slot:"footer"},[e("base-button",{attrs:{type:"neutral",link:""},nativeOn:{click:function(e){t.modals.transaction=!1}}},[t._v("Close\n            ")]),t._v(" "),e("nuxt-link",{staticClass:"btn btn-link btn-primary",attrs:{to:"/transactions"}},[t._v(t._s(t.$t("budget.get.modal.viewTransactions")))])],1)],2)],1)}),[],!1,null,null,null).exports},computed:{isRTL:function(){return this.$rtl.isRTL}}},j=Object(R.a)(O,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"content"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("card",{staticClass:"card",attrs:{"header-classes":{"text-right":t.isRTL}}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-6"},[e("h5",{staticClass:"card-title",attrs:{slot:"header"},slot:"header"},[t._v(t._s(t.$t("budget.get.title")))])]),t._v(" "),e("div",{staticClass:"col-6"},[e("nuxt-link",{staticClass:"btn btn-primary pull-right",attrs:{to:"/budget/add"}},[t._v("\n                            "+t._s(t.$t("budget.get.add-button"))+"\n                        ")])],1)]),t._v(" "),e("div",{staticClass:"table-responsive"},[e("display-budget")],1)])],1)])])}),[],!1,null,null,null);e.default=j.exports}}]);